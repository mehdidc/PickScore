[2024-02-14 15:41:41,602][trainer.accelerators.base_accelerator][INFO] - Setting seed 42
[2024-02-14 15:41:41,611][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=0
[2024-02-14 15:41:41,632][__main__][INFO] - Config can be found in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/config.yaml
[2024-02-14 15:41:41,632][__main__][INFO] - Loading task
[2024-02-14 15:41:41,865][__main__][INFO] - Loading model
[2024-02-14 15:41:41,943][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=1
[2024-02-14 15:41:41,943][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=2
[2024-02-14 15:41:54,631][__main__][INFO] - Loading criterion
[2024-02-14 15:41:54,632][__main__][INFO] - Loading optimizer
[2024-02-14 15:41:54,635][__main__][INFO] - Loading lr scheduler
[2024-02-14 15:41:54,636][__main__][INFO] - Loading dataloaders
[2024-02-14 15:41:54,637][trainer.datasetss.clip_hf_dataset][INFO] - Loading train dataset
[2024-02-14 15:41:59,954][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 1429230 examples from train dataset
[2024-02-14 15:41:59,956][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 1429230 examples from train dataset
[2024-02-14 15:42:00,832][trainer.datasetss.clip_hf_dataset][INFO] - Loading validation dataset
[2024-02-14 15:42:05,715][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 27916 examples from validation dataset
[2024-02-14 15:42:05,716][trainer.datasetss.clip_hf_dataset][INFO] - Keeping only examples with label in validation split
[2024-02-14 15:42:17,803][trainer.datasetss.clip_hf_dataset][INFO] - Kept 25769 examples from validation dataset
[2024-02-14 15:42:17,803][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 25769 examples from validation dataset
[2024-02-14 15:42:18,550][trainer.datasetss.clip_hf_dataset][INFO] - Loading test dataset
[2024-02-14 15:42:22,877][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 83830 examples from test dataset
[2024-02-14 15:42:22,877][trainer.datasetss.clip_hf_dataset][INFO] - Keeping only examples with label in test split
[2024-02-14 15:42:50,583][trainer.datasetss.clip_hf_dataset][INFO] - Kept 81505 examples from test dataset
[2024-02-14 15:42:50,583][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 81505 examples from test dataset
[2024-02-14 15:42:51,337][accelerate.accelerator][INFO] - Since you passed both train and evaluation dataloader, `is_train_batch_min` (here True will decide the `train_batch_size` (32).
[2024-02-14 15:43:04,545][trainer.accelerators.base_accelerator][INFO] - No checkpoint found, training from scratch
[2024-02-14 15:43:04,546][trainer.accelerators.base_accelerator][INFO] - Total training batches: 14888
[2024-02-14 15:43:04,546][trainer.accelerators.base_accelerator][INFO] - Number of update steps per epoch: 931
[2024-02-14 15:43:04,587][trainer.accelerators.base_accelerator][INFO] - Initializing trackers
[2024-02-14 15:43:07,333][trainer.accelerators.base_accelerator][INFO] - Training config:
[2024-02-14 15:43:07,379][trainer.accelerators.base_accelerator][INFO] - {'accelerator': {'_target_': 'trainer.accelerators.deepspeed_accelerator.DeepSpeedAccelerator', 'output_dir': '${output_dir}', 'mixed_precision': <PrecisionType.BF16: 'bf16'>, 'gradient_accumulation_steps': 16, 'log_with': <LoggerType.WANDB: 'wandb'>, 'debug': {'activate': False, 'port': 5900}, 'seed': 42, 'resume_from_checkpoint': True, 'max_steps': 3000, 'num_epochs': 4, 'validate_steps': 100, 'eval_on_start': True, 'project_name': 'experiment', 'max_grad_norm': 1.0, 'save_steps': 100, 'metric_name': 'accuracy', 'metric_mode': <MetricMode.MAX: 'max'>, 'limit_num_checkpoints': 1, 'save_only_if_best': True, 'dynamo_backend': <DynamoBackend.NO: 'NO'>, 'keep_best_ckpts': True, 'deepspeed': {'fp16': {'enabled': False}, 'bf16': {'enabled': True}, 'optimizer': {'type': 'AdamW', 'params': {'lr': 'auto', 'weight_decay': 'auto', 'torch_adam': True, 'adam_w_mode': True}}, 'scheduler': {'type': 'WarmupDecayLR', 'params': {'warmup_min_lr': 'auto', 'warmup_max_lr': 'auto', 'warmup_num_steps': 'auto', 'total_num_steps': 'auto'}}, 'zero_optimization': {'stage': 2, 'allgather_partitions': True, 'allgather_bucket_size': 200000000.0, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 500000000, 'contiguous_gradients': True}, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 1, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False}, 'deepspeed_final': {'fp16': {'enabled': False}, 'bf16': {'enabled': True}, 'optimizer': {'type': 'AdamW', 'params': {'lr': 'auto', 'weight_decay': 'auto', 'torch_adam': True, 'adam_w_mode': True}}, 'scheduler': {'type': 'WarmupDecayLR', 'params': {'warmup_min_lr': 'auto', 'warmup_max_lr': 'auto', 'warmup_num_steps': 'auto', 'total_num_steps': 'auto'}}, 'zero_optimization': {'stage': 2, 'allgather_partitions': True, 'allgather_bucket_size': 200000000.0, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 500000000, 'contiguous_gradients': True}, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False}}, 'task': {'limit_examples_to_wandb': 5, '_target_': 'trainer.tasks.clip_task.CLIPTask', 'pretrained_model_name_or_path': '${model.pretrained_model_name_or_path}', 'label_0_column_name': '${dataset.label_0_column_name}', 'label_1_column_name': '${dataset.label_1_column_name}', 'input_ids_column_name': '${dataset.input_ids_column_name}', 'pixels_0_column_name': '${dataset.pixels_0_column_name}', 'pixels_1_column_name': '${dataset.pixels_1_column_name}'}, 'model': {'_target_': 'trainer.models.clip_model.CLIPModel', 'pretrained_model_name_or_path': 'laion/CLIP-ViT-H-14-laion2B-s32B-b79K'}, 'criterion': {'_target_': 'trainer.criterions.clip_criterion.CLIPCriterion', 'is_distributed': True, 'label_0_column_name': '${dataset.label_0_column_name}', 'label_1_column_name': '${dataset.label_1_column_name}', 'input_ids_column_name': '${dataset.input_ids_column_name}', 'pixels_0_column_name': '${dataset.pixels_0_column_name}', 'pixels_1_column_name': '${dataset.pixels_1_column_name}', 'num_examples_per_prompt_column_name': '${dataset.num_examples_per_prompt_column_name}', 'in_batch_negatives': False}, 'dataset': {'train_split_name': 'train', 'valid_split_name': 'validation', 'test_split_name': 'test', 'batch_size': 32, 'num_workers': 2, 'drop_last': True, '_target_': 'trainer.datasetss.clip_hf_dataset.CLIPHFDataset', 'dataset_name': 'mehdidc/compositionality', 'dataset_config_name': 'null', 'from_disk': False, 'cache_dir': '/home/vu214/rds/rds-shared-data-HM7VddDwcug/shared-datasets/reward_models_data', 'caption_column_name': 'caption', 'input_ids_column_name': 'input_ids', 'image_0_column_name': 'jpg_0', 'image_1_column_name': 'jpg_1', 'label_0_column_name': 'label_0', 'label_1_column_name': 'label_1', 'are_different_column_name': 'are_different', 'has_label_column_name': 'has_label', 'pixels_0_column_name': 'pixel_values_0', 'pixels_1_column_name': 'pixel_values_1', 'num_examples_per_prompt_column_name': 'num_example_per_prompt', 'keep_only_different': False, 'keep_only_with_label': False, 'keep_only_with_label_in_non_train': True, 'dataset_size_train': None, 'dataset_size_validation': None, 'dataset_size_test': None, 'processor': {'_target_': 'transformers.AutoProcessor.from_pretrained', 'pretrained_model_name_or_path': '${model.pretrained_model_name_or_path}'}, 'limit_examples_per_prompt': -1, 'caption_sources': None, 'model_sources': None, 'origin': None, 'only_on_best': False}, 'optimizer': {'_target_': 'trainer.optimizers.dummy_optimizer.BaseDummyOptim', 'lr': 3e-06, 'weight_decay': 0.3}, 'lr_scheduler': {'_target_': 'trainer.lr_schedulers.dummy_lr_scheduler.instantiate_dummy_lr_scheduler', 'lr': '${optimizer.lr}', 'lr_warmup_steps': 500, 'total_num_steps': '${accelerator.max_steps}'}, 'debug': {'activate': False, 'port': 5900}, 'output_dir': '/rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering'}
[2024-02-14 15:43:07,461][trainer.accelerators.base_accelerator][INFO] - nvidia-smi stats: {'gpu_0_mem_used_gb': 10.19921875, 'gpu_1_mem_used_gb': 10.29296875, 'gpu_2_mem_used_gb': 10.29296875}
[2024-02-14 15:43:07,462][trainer.accelerators.base_accelerator][INFO] - ***** Running training *****
[2024-02-14 15:43:07,462][trainer.accelerators.base_accelerator][INFO] -   Instantaneous batch size per device = 32
[2024-02-14 15:43:07,462][trainer.accelerators.base_accelerator][INFO] -   Total train batch size (w. parallel, distributed & accumulation) = 1536
[2024-02-14 15:43:07,462][trainer.accelerators.base_accelerator][INFO] -   Gradient Accumulation steps = 16
[2024-02-14 15:43:07,462][trainer.accelerators.base_accelerator][INFO] -   Total warmup steps = 500
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Total training steps = 48000
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Total epochs = 4
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Steps per epoch = 14888
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Update steps per epoch = 931
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Total optimization steps = 3000
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   Mixed precision = bf16
[2024-02-14 15:43:07,463][trainer.accelerators.base_accelerator][INFO] -   World size = 3
[2024-02-14 15:43:07,465][__main__][INFO] - task: CLIPTask
[2024-02-14 15:43:07,465][__main__][INFO] - model: DeepSpeedEngine
[2024-02-14 15:43:07,468][__main__][INFO] - num. model params: 986M
[2024-02-14 15:43:07,471][__main__][INFO] - num. model trainable params: 986M
[2024-02-14 15:43:07,471][__main__][INFO] - criterion: CLIPCriterion
[2024-02-14 15:43:07,471][__main__][INFO] - num. train examples: 1429230
[2024-02-14 15:43:07,471][__main__][INFO] - num. valid examples: 25769
[2024-02-14 15:43:07,471][__main__][INFO] - num. test examples: 81505
[2024-02-14 16:20:31,211][trainer.accelerators.base_accelerator][INFO] - Not cleaning up checkpoints as only 0 checkpoints found
[2024-02-14 16:20:31,281][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-14 16:20:31,284][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-14 16:20:31,284][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-14 16:20:38,386][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100/pytorch_model
[2024-02-14 16:20:38,539][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100/random_states_0.pkl
[2024-02-14 16:20:38,541][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-14 22:47:32,049][trainer.accelerators.base_accelerator][INFO] - Setting seed 42
[2024-02-14 22:47:32,075][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=0
[2024-02-14 22:47:32,112][__main__][INFO] - Config can be found in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/config.yaml
[2024-02-14 22:47:32,112][__main__][INFO] - Loading task
[2024-02-14 22:47:32,471][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=2
[2024-02-14 22:47:32,471][trainer.accelerators.base_accelerator][INFO] - Initialized accelerator: rank=1
[2024-02-14 22:47:32,790][__main__][INFO] - Loading model
[2024-02-14 22:48:08,808][__main__][INFO] - Loading criterion
[2024-02-14 22:48:08,808][__main__][INFO] - Loading optimizer
[2024-02-14 22:48:08,811][__main__][INFO] - Loading lr scheduler
[2024-02-14 22:48:08,812][__main__][INFO] - Loading dataloaders
[2024-02-14 22:48:08,813][trainer.datasetss.clip_hf_dataset][INFO] - Loading train dataset
[2024-02-14 22:48:15,709][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 1429230 examples from train dataset
[2024-02-14 22:48:15,710][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 1429230 examples from train dataset
[2024-02-14 22:48:16,699][trainer.datasetss.clip_hf_dataset][INFO] - Loading validation dataset
[2024-02-14 22:48:21,012][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 27916 examples from validation dataset
[2024-02-14 22:48:21,012][trainer.datasetss.clip_hf_dataset][INFO] - Keeping only examples with label in validation split
[2024-02-14 22:49:14,008][trainer.datasetss.clip_hf_dataset][INFO] - Kept 25769 examples from validation dataset
[2024-02-14 22:49:14,009][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 25769 examples from validation dataset
[2024-02-14 22:49:14,763][trainer.datasetss.clip_hf_dataset][INFO] - Loading test dataset
[2024-02-14 22:49:19,327][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 83830 examples from test dataset
[2024-02-14 22:49:19,328][trainer.datasetss.clip_hf_dataset][INFO] - Keeping only examples with label in test split
[2024-02-14 22:51:19,602][trainer.datasetss.clip_hf_dataset][INFO] - Kept 81505 examples from test dataset
[2024-02-14 22:51:19,602][trainer.datasetss.clip_hf_dataset][INFO] - Loaded 81505 examples from test dataset
[2024-02-14 22:51:20,634][accelerate.accelerator][INFO] - Since you passed both train and evaluation dataloader, `is_train_batch_min` (here True will decide the `train_batch_size` (32).
[2024-02-14 22:51:38,477][trainer.accelerators.base_accelerator][INFO] - No checkpoint found, training from scratch
[2024-02-14 22:51:38,478][trainer.accelerators.base_accelerator][INFO] - Total training batches: 14888
[2024-02-14 22:51:38,478][trainer.accelerators.base_accelerator][INFO] - Number of update steps per epoch: 931
[2024-02-14 22:51:38,518][trainer.accelerators.base_accelerator][INFO] - Initializing trackers
[2024-02-14 22:51:41,610][trainer.accelerators.base_accelerator][INFO] - Training config:
[2024-02-14 22:51:41,681][trainer.accelerators.base_accelerator][INFO] - {'accelerator': {'_target_': 'trainer.accelerators.deepspeed_accelerator.DeepSpeedAccelerator', 'output_dir': '${output_dir}', 'mixed_precision': <PrecisionType.BF16: 'bf16'>, 'gradient_accumulation_steps': 16, 'log_with': <LoggerType.WANDB: 'wandb'>, 'debug': {'activate': False, 'port': 5900}, 'seed': 42, 'resume_from_checkpoint': True, 'max_steps': 3000, 'num_epochs': 4, 'validate_steps': 500, 'eval_on_start': True, 'project_name': 'experiment', 'max_grad_norm': 1.0, 'save_steps': 100, 'metric_name': 'accuracy', 'metric_mode': <MetricMode.MAX: 'max'>, 'limit_num_checkpoints': 1, 'save_only_if_best': True, 'dynamo_backend': <DynamoBackend.NO: 'NO'>, 'keep_best_ckpts': True, 'deepspeed': {'fp16': {'enabled': False}, 'bf16': {'enabled': True}, 'optimizer': {'type': 'AdamW', 'params': {'lr': 'auto', 'weight_decay': 'auto', 'torch_adam': True, 'adam_w_mode': True}}, 'scheduler': {'type': 'WarmupDecayLR', 'params': {'warmup_min_lr': 'auto', 'warmup_max_lr': 'auto', 'warmup_num_steps': 'auto', 'total_num_steps': 'auto'}}, 'zero_optimization': {'stage': 2, 'allgather_partitions': True, 'allgather_bucket_size': 200000000.0, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 500000000, 'contiguous_gradients': True}, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 1, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False}, 'deepspeed_final': {'fp16': {'enabled': False}, 'bf16': {'enabled': True}, 'optimizer': {'type': 'AdamW', 'params': {'lr': 'auto', 'weight_decay': 'auto', 'torch_adam': True, 'adam_w_mode': True}}, 'scheduler': {'type': 'WarmupDecayLR', 'params': {'warmup_min_lr': 'auto', 'warmup_max_lr': 'auto', 'warmup_num_steps': 'auto', 'total_num_steps': 'auto'}}, 'zero_optimization': {'stage': 2, 'allgather_partitions': True, 'allgather_bucket_size': 200000000.0, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 500000000, 'contiguous_gradients': True}, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False}}, 'task': {'limit_examples_to_wandb': 5, '_target_': 'trainer.tasks.clip_task.CLIPTask', 'pretrained_model_name_or_path': '${model.pretrained_model_name_or_path}', 'label_0_column_name': '${dataset.label_0_column_name}', 'label_1_column_name': '${dataset.label_1_column_name}', 'input_ids_column_name': '${dataset.input_ids_column_name}', 'pixels_0_column_name': '${dataset.pixels_0_column_name}', 'pixels_1_column_name': '${dataset.pixels_1_column_name}'}, 'model': {'_target_': 'trainer.models.clip_model.CLIPModel', 'pretrained_model_name_or_path': 'laion/CLIP-ViT-H-14-laion2B-s32B-b79K'}, 'criterion': {'_target_': 'trainer.criterions.clip_criterion.CLIPCriterion', 'is_distributed': True, 'label_0_column_name': '${dataset.label_0_column_name}', 'label_1_column_name': '${dataset.label_1_column_name}', 'input_ids_column_name': '${dataset.input_ids_column_name}', 'pixels_0_column_name': '${dataset.pixels_0_column_name}', 'pixels_1_column_name': '${dataset.pixels_1_column_name}', 'num_examples_per_prompt_column_name': '${dataset.num_examples_per_prompt_column_name}', 'in_batch_negatives': False}, 'dataset': {'train_split_name': 'train', 'valid_split_name': 'validation', 'test_split_name': 'test', 'batch_size': 32, 'num_workers': 2, 'drop_last': True, '_target_': 'trainer.datasetss.clip_hf_dataset.CLIPHFDataset', 'dataset_name': 'mehdidc/compositionality', 'dataset_config_name': 'null', 'from_disk': False, 'cache_dir': '/home/vu214/rds/rds-shared-data-HM7VddDwcug/shared-datasets/reward_models_data', 'caption_column_name': 'caption', 'input_ids_column_name': 'input_ids', 'image_0_column_name': 'jpg_0', 'image_1_column_name': 'jpg_1', 'label_0_column_name': 'label_0', 'label_1_column_name': 'label_1', 'are_different_column_name': 'are_different', 'has_label_column_name': 'has_label', 'pixels_0_column_name': 'pixel_values_0', 'pixels_1_column_name': 'pixel_values_1', 'num_examples_per_prompt_column_name': 'num_example_per_prompt', 'keep_only_different': False, 'keep_only_with_label': False, 'keep_only_with_label_in_non_train': True, 'dataset_size_train': None, 'dataset_size_validation': None, 'dataset_size_test': None, 'processor': {'_target_': 'transformers.AutoProcessor.from_pretrained', 'pretrained_model_name_or_path': '${model.pretrained_model_name_or_path}'}, 'limit_examples_per_prompt': -1, 'caption_sources': None, 'model_sources': None, 'origin': None, 'only_on_best': False}, 'optimizer': {'_target_': 'trainer.optimizers.dummy_optimizer.BaseDummyOptim', 'lr': 3e-06, 'weight_decay': 0.3}, 'lr_scheduler': {'_target_': 'trainer.lr_schedulers.dummy_lr_scheduler.instantiate_dummy_lr_scheduler', 'lr': '${optimizer.lr}', 'lr_warmup_steps': 500, 'total_num_steps': '${accelerator.max_steps}'}, 'debug': {'activate': False, 'port': 5900}, 'output_dir': '/rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering'}
[2024-02-14 22:51:41,758][trainer.accelerators.base_accelerator][INFO] - nvidia-smi stats: {'gpu_0_mem_used_gb': 10.19921875, 'gpu_1_mem_used_gb': 10.29296875, 'gpu_2_mem_used_gb': 10.29296875}
[2024-02-14 22:51:41,759][trainer.accelerators.base_accelerator][INFO] - ***** Running training *****
[2024-02-14 22:51:41,759][trainer.accelerators.base_accelerator][INFO] -   Instantaneous batch size per device = 32
[2024-02-14 22:51:41,759][trainer.accelerators.base_accelerator][INFO] -   Total train batch size (w. parallel, distributed & accumulation) = 1536
[2024-02-14 22:51:41,759][trainer.accelerators.base_accelerator][INFO] -   Gradient Accumulation steps = 16
[2024-02-14 22:51:41,759][trainer.accelerators.base_accelerator][INFO] -   Total warmup steps = 500
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Total training steps = 48000
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Total epochs = 4
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Steps per epoch = 14888
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Update steps per epoch = 931
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Total optimization steps = 3000
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   Mixed precision = bf16
[2024-02-14 22:51:41,760][trainer.accelerators.base_accelerator][INFO] -   World size = 3
[2024-02-14 22:51:41,761][__main__][INFO] - task: CLIPTask
[2024-02-14 22:51:41,762][__main__][INFO] - model: DeepSpeedEngine
[2024-02-14 22:51:41,764][__main__][INFO] - num. model params: 986M
[2024-02-14 22:51:41,766][__main__][INFO] - num. model trainable params: 986M
[2024-02-14 22:51:41,767][__main__][INFO] - criterion: CLIPCriterion
[2024-02-14 22:51:41,767][__main__][INFO] - num. train examples: 1429230
[2024-02-14 22:51:41,767][__main__][INFO] - num. valid examples: 25769
[2024-02-14 22:51:41,767][__main__][INFO] - num. test examples: 81505
[2024-02-14 22:51:53,993][__main__][INFO] - *** Evaluating validation ***
[2024-02-14 22:51:53,994][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-14 22:54:13,587][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-14 22:54:13,591][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.5959185254027262, 'num_samples': 25824}
[2024-02-14 23:42:51,007][trainer.accelerators.base_accelerator][INFO] - Not cleaning up checkpoints as only 0 checkpoints found
[2024-02-14 23:42:51,008][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-14 23:42:51,010][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-14 23:42:51,010][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-14 23:42:58,377][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100/pytorch_model
[2024-02-14 23:42:58,379][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100/random_states_0.pkl
[2024-02-14 23:42:58,380][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-15 00:13:40,482][trainer.accelerators.base_accelerator][INFO] - Not cleaning up checkpoints as only 1 checkpoints found
[2024-02-15 00:13:40,569][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200
[2024-02-15 00:13:40,570][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200
[2024-02-15 00:13:40,570][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 00:13:48,128][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200/pytorch_model
[2024-02-15 00:13:48,336][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200/random_states_0.pkl
[2024-02-15 00:13:48,338][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200
[2024-02-15 00:44:22,779][trainer.accelerators.base_accelerator][INFO] - Found 2 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 00:44:22,782][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300
[2024-02-15 00:44:22,783][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300
[2024-02-15 00:44:22,783][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 00:44:30,143][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300/pytorch_model
[2024-02-15 00:44:30,146][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300/random_states_0.pkl
[2024-02-15 00:44:30,147][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300
[2024-02-15 01:15:07,586][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 01:15:07,588][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep200
[2024-02-15 01:15:11,504][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400
[2024-02-15 01:15:11,516][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400
[2024-02-15 01:15:11,516][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 01:15:23,630][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400/pytorch_model
[2024-02-15 01:15:23,633][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400/random_states_0.pkl
[2024-02-15 01:15:23,644][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400
[2024-02-15 01:46:02,608][__main__][INFO] - *** Evaluating validation ***
[2024-02-15 01:46:02,609][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-15 01:48:22,082][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-15 01:48:22,470][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.6625425960346965, 'num_samples': 25824}
[2024-02-15 01:48:22,474][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 01:48:22,476][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep300
[2024-02-15 01:48:25,045][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500
[2024-02-15 01:48:25,046][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500
[2024-02-15 01:48:25,046][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 01:48:33,163][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500/pytorch_model
[2024-02-15 01:48:33,188][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500/random_states_0.pkl
[2024-02-15 01:48:33,191][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500
[2024-02-15 02:19:07,668][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 02:19:07,670][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep100
[2024-02-15 02:19:07,675][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600
[2024-02-15 02:19:07,676][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600
[2024-02-15 02:19:07,676][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 02:19:14,829][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600/pytorch_model
[2024-02-15 02:19:14,831][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600/random_states_0.pkl
[2024-02-15 02:19:14,832][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600
[2024-02-15 02:49:52,042][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 02:49:52,044][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep400
[2024-02-15 02:49:52,050][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700
[2024-02-15 02:49:52,051][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700
[2024-02-15 02:49:52,051][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 02:49:59,757][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700/pytorch_model
[2024-02-15 02:49:59,760][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700/random_states_0.pkl
[2024-02-15 02:49:59,761][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700
[2024-02-15 03:20:43,048][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 03:20:43,051][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep500
[2024-02-15 03:20:43,056][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800
[2024-02-15 03:20:43,057][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800
[2024-02-15 03:20:43,057][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 03:20:50,712][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800/pytorch_model
[2024-02-15 03:20:50,855][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800/random_states_0.pkl
[2024-02-15 03:20:50,857][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800
[2024-02-15 03:51:30,228][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 03:51:30,230][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep700
[2024-02-15 03:51:35,035][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900
[2024-02-15 03:51:35,039][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900
[2024-02-15 03:51:35,040][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 03:51:49,969][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900/pytorch_model
[2024-02-15 03:51:50,035][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900/random_states_0.pkl
[2024-02-15 03:51:50,036][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900
[2024-02-15 04:01:30,887][trainer.accelerators.base_accelerator][INFO] - Epoch 0 finished
[2024-02-15 04:22:41,543][__main__][INFO] - *** Evaluating validation ***
[2024-02-15 04:22:41,544][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-15 04:24:58,130][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-15 04:24:58,492][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.6743726765799256, 'num_samples': 25824}
[2024-02-15 04:24:58,496][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 04:24:58,498][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep800
[2024-02-15 04:25:01,386][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000
[2024-02-15 04:25:01,387][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000
[2024-02-15 04:25:01,387][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 04:25:11,279][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000/pytorch_model
[2024-02-15 04:25:11,281][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000/random_states_0.pkl
[2024-02-15 04:25:11,283][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000
[2024-02-15 04:55:55,279][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 04:55:55,281][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep600
[2024-02-15 04:55:55,298][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100
[2024-02-15 04:55:55,298][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100
[2024-02-15 04:55:55,298][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 04:56:02,921][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100/pytorch_model
[2024-02-15 04:56:02,979][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100/random_states_0.pkl
[2024-02-15 04:56:02,981][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100
[2024-02-15 05:26:41,596][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 05:26:41,599][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep900
[2024-02-15 05:26:41,618][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1200
[2024-02-15 05:26:41,619][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1200
[2024-02-15 05:26:41,619][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 05:26:49,631][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1200/pytorch_model
[2024-02-15 05:26:49,812][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1200/random_states_0.pkl
[2024-02-15 05:26:49,813][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1200
[2024-02-15 05:57:32,126][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 05:57:32,129][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1100
[2024-02-15 05:57:35,451][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1300
[2024-02-15 05:57:35,453][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1300
[2024-02-15 05:57:35,453][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 05:57:44,489][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1300/pytorch_model
[2024-02-15 05:57:44,533][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1300/random_states_0.pkl
[2024-02-15 05:57:44,534][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1300
[2024-02-15 06:28:21,896][trainer.accelerators.base_accelerator][INFO] - Found 3 checkpoints in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering
[2024-02-15 06:28:21,899][trainer.accelerators.base_accelerator][INFO] - Deleting checkpoint /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1000
[2024-02-15 06:28:21,904][trainer.accelerators.base_accelerator][INFO] - Saving checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400
[2024-02-15 06:28:21,905][accelerate.accelerator][INFO] - Saving current state to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400
[2024-02-15 06:28:21,905][accelerate.accelerator][INFO] - Saving DeepSpeed Model and Optimizer
[2024-02-15 06:28:29,594][accelerate.accelerator][INFO] - DeepSpeed Model and Optimizer saved to output dir /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400/pytorch_model
[2024-02-15 06:28:29,598][accelerate.checkpointing][INFO] - Random states saved in /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400/random_states_0.pkl
[2024-02-15 06:28:29,599][trainer.accelerators.base_accelerator][INFO] - Saved checkpoint to /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400
[2024-02-15 06:59:07,923][__main__][INFO] - *** Evaluating validation ***
[2024-02-15 06:59:07,923][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-15 07:01:26,342][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-15 07:01:27,258][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.6658147459727385, 'num_samples': 25824}
[2024-02-15 07:01:27,387][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6658147459727385 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 07:32:08,795][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6658147459727385 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 08:02:48,873][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6658147459727385 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 08:33:31,794][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6658147459727385 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 08:52:22,068][trainer.accelerators.base_accelerator][INFO] - Epoch 1 finished
[2024-02-15 09:04:03,666][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6658147459727385 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 09:34:49,004][__main__][INFO] - *** Evaluating validation ***
[2024-02-15 09:34:49,005][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-15 09:37:05,529][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-15 09:37:05,534][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.6645368649318464, 'num_samples': 25824}
[2024-02-15 09:37:05,536][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6645368649318464 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 10:07:48,061][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6645368649318464 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 10:38:27,076][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6645368649318464 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 11:09:05,372][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6645368649318464 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 11:39:43,330][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6645368649318464 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 12:10:20,322][__main__][INFO] - *** Evaluating validation ***
[2024-02-15 12:10:20,323][trainer.tasks.clip_task][INFO] - Running clip score...
[2024-02-15 12:12:39,007][trainer.tasks.base_task][INFO] - Gathering dict from all processes...
[2024-02-15 12:12:39,068][trainer.accelerators.base_accelerator][INFO] - Metrics: {'accuracy': 0.6652919764560099, 'num_samples': 25824}
[2024-02-15 12:12:39,084][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6652919764560099 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 12:43:15,666][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6652919764560099 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 13:13:54,837][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6652919764560099 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
[2024-02-15 13:42:23,081][trainer.accelerators.base_accelerator][INFO] - Epoch 2 finished
[2024-02-15 13:44:34,464][trainer.accelerators.base_accelerator][INFO] - Metric accuracy=0.6652919764560099 is not better than 0.6743726765799256 of /rds/project/rds-lSmP1cwRttU/vu214/reward-models-compositionality-resources/pickscore_trained_model_outputs_full_dataset_no_filtering/checkpoint-gstep1400, skipping checkpoint
